angular.module('angularvideo', ['ui.router', 'ngSanitize']).config(["$stateProvider", "$urlRouterProvider", function($stateProvider, $urlRouterProvider) {
  $urlRouterProvider.otherwise('/videos');
  return $stateProvider.state('videos', {
    url: '/videos',
    templateUrl: 'videos.tpl.html',
    controller: 'VideosCtrl'
  }).state('video', {
    url: '/video/:id',
    templateUrl: 'video.tpl.html',
    controller: 'VideoCtrl'
  });
}]);

angular.module('angularvideo').controller('VideoCtrl', ["$scope", "$sce", "$stateParams", "Videos", function($scope, $sce, $stateParams, Videos) {
  var idVideo;
  idVideo = JSON.parse($stateParams.id);
  return Videos.getOne(idVideo).then(function(video) {
    video.src = $sce.trustAsResourceUrl(video.src);
    return $scope.video = video;
  }, function(reason) {
    return alert(reason);
  });
}]);

angular.module('angularvideo').directive('secondsToMinutes', function() {
  return {
    link: function(scope, element, attr) {
      var secondsToMinutes;
      secondsToMinutes = function(time) {
        var hrs, mins, ret, secs;
        mins = ~~(time / 60);
        secs = time % 60;
        hrs = ~~(time / 3600);
        mins = ~~(time % 3600 / 60);
        secs = time % 60;
        ret = '';
        if (mins < 10) {
          mins = '0' + mins;
        }
        if (hrs > 0) {
          ret += '' + hrs + ':' + (mins < 10 ? '0' : '');
        }
        ret += '' + mins + ':' + (secs < 10 ? '0' : '');
        ret += '' + secs;
        return ret;
      };
      return element.replaceWith(secondsToMinutes(attr.secondsToMinutes));
    }
  };
});

angular.module('angularvideo').directive('videoInterface', function() {
  return {
    link: function(scope, element, attr) {
      var listener, videoEl, videoSrc;
      videoEl = document.createElement('video');
      videoSrc = document.createElement('source');
      videoEl.setAttribute('controls', true);
      videoSrc.setAttribute('type', 'video/mp4');
      videoEl.appendChild(videoSrc);
      element.replaceWith(videoEl);
      listener = scope.$watch('video', function(video) {
        if (video != null) {
          videoSrc.setAttribute('src', video.src);
          videoEl.load();
          return listener();
        }
      });
      return scope.setTime = function(time) {
        return videoEl.currentTime = time;
      };
    }
  };
});

angular.module('angularvideo').controller('VideosCtrl', ["$scope", "Videos", function($scope, Videos) {
  $scope.videos = [];
  return Videos.getAll().then(function(videos) {
    return $scope.videos = videos.data;
  }, function(reason) {
    return alert(reason);
  });
}]);

angular.module('angularvideo').factory('Videos', ["$http", "$q", function($http, $q) {
  return {
    getAll: function() {
      var deferred;
      deferred = $q.defer();
      $http.get('/api/videos').success(function(data, status, headers, config) {
        return deferred.resolve(data, status, headers, config);
      }).error(function(data, status, headers, config) {
        return deferred.reject(data, status, headers, config);
      });
      return deferred.promise;
    },
    getOne: function(id) {
      var deferred;
      deferred = $q.defer();
      $http.get("/api/videos/one/" + parseInt(id)).success(function(data, status, headers, config) {
        return deferred.resolve(data, status, headers, config);
      }).error(function(data, status, headers, config) {
        return deferred.reject(data, status, headers, config);
      });
      return deferred.promise;
    }
  };
}]);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5jb2ZmZWUiLCJhcHAuanMiLCJ2aWRlby9jb250cm9sbGVyLmNvZmZlZSIsInZpZGVvL2NvbnRyb2xsZXIuanMiLCJ2aWRlby9zZWNvbmRzVG9NaW51dGVzLmNvZmZlZSIsInZpZGVvL3NlY29uZHNUb01pbnV0ZXMuanMiLCJ2aWRlby92aWRlb2ludGVyZmFjZS5jb2ZmZWUiLCJ2aWRlby92aWRlb2ludGVyZmFjZS5qcyIsInZpZGVvcy9jb250cm9sbGVyLmNvZmZlZSIsInZpZGVvcy9jb250cm9sbGVyLmpzIiwic2hhcmVkL3NlcnZpY2UuY29mZmVlIiwic2hhcmVkL3NlcnZpY2UuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsUUFBUSxPQUFPLGdCQUFnQixDQUMzQixhQUNBLGVBRUgsZ0RBQU8sU0FBQyxnQkFBZ0Isb0JBQWpCO0VBRUosbUJBQW1CLFVBQVU7RUNKL0IsT0RNRSxlQUNLLE1BQU0sVUFDSDtJQUFBLEtBQUs7SUFDTCxhQUFhO0lBQ2IsWUFBWTtLQUNmLE1BQU0sU0FDSDtJQUFBLEtBQUs7SUFDTCxhQUFhO0lBQ2IsWUFBWTs7O0FDSnhCO0FDWkEsUUFBUSxPQUFPLGdCQUFnQixXQUFXLDBEQUFhLFNBQUMsUUFBUSxNQUFNLGNBQWMsUUFBN0I7RUFDbkQsSUFBQTtFQUFBLFVBQVUsS0FBSyxNQUFNLGFBQWE7RUNFcEMsT0RERSxPQUFPLE9BQU8sU0FBUyxLQUFLLFNBQUMsT0FBRDtJQUV4QixNQUFNLE1BQU0sS0FBSyxtQkFBbUIsTUFBTTtJQ0M5QyxPREFJLE9BQU8sUUFBUTtLQUNqQixTQUFDLFFBQUQ7SUNDRixPREFJLE1BQU07OztBQ0dkO0FDVkEsUUFBUSxPQUFPLGdCQUFnQixVQUFVLG9CQUFvQixXQUFBO0VDQzNELE9EQUU7SUFDSSxNQUFNLFNBQUMsT0FBTyxTQUFTLE1BQWpCO01BQ0YsSUFBQTtNQUFBLG1CQUFtQixTQUFDLE1BQUQ7UUFDZixJQUFBLEtBQUEsTUFBQSxLQUFBO1FBQUEsT0FBTyxDQUFBLEVBQUksT0FBTztRQUNsQixPQUFPLE9BQU87UUFDZCxNQUFNLENBQUEsRUFBSSxPQUFPO1FBQ2pCLE9BQU8sQ0FBQSxFQUFJLE9BQU8sT0FBTztRQUN6QixPQUFPLE9BQU87UUFDZCxNQUFNO1FBQ04sSUFBRyxPQUFPLElBQVY7VUFBa0IsT0FBTyxNQUFNOztRQUMvQixJQUFHLE1BQU0sR0FBVDtVQUNFLE9BQU8sS0FBSyxNQUFNLE9BQVUsT0FBTyxLQUFRLE1BQVM7O1FBQ3RELE9BQU8sS0FBSyxPQUFPLE9BQVUsT0FBTyxLQUFRLE1BQVM7UUFDckQsT0FBTyxLQUFLO1FBQ1osT0FBTzs7TUNPakIsT0ROTSxRQUFRLFlBQVksaUJBQWlCLEtBQUs7Ozs7QUNVdEQ7QUMxQkEsUUFBUSxPQUFPLGdCQUFnQixVQUFVLGtCQUFrQixXQUFBO0VDQ3pELE9EQUU7SUFDSSxNQUFNLFNBQUMsT0FBTyxTQUFTLE1BQWpCO01BQ0YsSUFBQSxVQUFBLFNBQUE7TUFBQSxVQUFVLFNBQVMsY0FBYztNQUNqQyxXQUFXLFNBQVMsY0FBYztNQUNsQyxRQUFRLGFBQWEsWUFBWTtNQUNqQyxTQUFTLGFBQWEsUUFBUTtNQUM5QixRQUFRLFlBQVk7TUFDcEIsUUFBUSxZQUFZO01BQ3BCLFdBQVcsTUFBTSxPQUFPLFNBQVMsU0FBQyxPQUFEO1FBQzdCLElBQUcsU0FBQSxNQUFIO1VBQ0ksU0FBUyxhQUFhLE9BQU8sTUFBTTtVQUNuQyxRQUFRO1VDRWxCLE9ERFU7OztNQ0lkLE9ERk0sTUFBTSxVQUFVLFNBQUMsTUFBRDtRQ0dwQixPREZRLFFBQVEsY0FBYzs7Ozs7QUNPdEM7QUN2QkEsUUFBUSxPQUFPLGdCQUFnQixXQUFXLG1DQUFjLFNBQUMsUUFBUSxRQUFUO0VBQ3BELE9BQU8sU0FBUztFQ0NsQixPREFFLE9BQU8sU0FBUyxLQUFLLFNBQUMsUUFBRDtJQ0NyQixPREFJLE9BQU8sU0FBUyxPQUFPO0tBQ3pCLFNBQUMsUUFBRDtJQ0NGLE9EQUksTUFBTTs7O0FDR2Q7QUNSQSxRQUFRLE9BQU8sZ0JBQWdCLFFBQVEsMEJBQVUsU0FBQyxPQUFPLElBQVI7RUNDL0MsT0RBRTtJQUNJLFFBQVEsV0FBQTtNQUNKLElBQUE7TUFBQSxXQUFXLEdBQUc7TUFDZCxNQUFNLElBQUksZUFDTCxRQUFRLFNBQUMsTUFBTSxRQUFRLFNBQVMsUUFBeEI7UUNDakIsT0RBWSxTQUFTLFFBQVEsTUFBTSxRQUFRLFNBQVM7U0FFM0MsTUFBTSxTQUFDLE1BQU0sUUFBUSxTQUFTLFFBQXhCO1FDQWYsT0RDWSxTQUFTLE9BQU8sTUFBTSxRQUFRLFNBQVM7O01BRS9DLE9BQU8sU0FBUzs7SUFDcEIsUUFBUSxTQUFDLElBQUQ7TUFDSixJQUFBO01BQUEsV0FBVyxHQUFHO01BQ2QsTUFBTSxJQUFJLHFCQUFxQixTQUFTLEtBQ25DLFFBQVEsU0FBQyxNQUFNLFFBQVEsU0FBUyxRQUF4QjtRQ0NqQixPREFZLFNBQVMsUUFBUSxNQUFNLFFBQVEsU0FBUztTQUUzQyxNQUFNLFNBQUMsTUFBTSxRQUFRLFNBQVMsUUFBeEI7UUNBZixPRENZLFNBQVMsT0FBTyxNQUFNLFFBQVEsU0FBUzs7TUFFL0MsT0FBTyxTQUFTOzs7O0FDRzVCIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYW5ndWxhcnZpZGVvJywgW1xuICAgICd1aS5yb3V0ZXInLFxuICAgICduZ1Nhbml0aXplJ1xuXSlcbi5jb25maWcgKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIC0+XG5cbiAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvdmlkZW9zJylcblxuICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgIC5zdGF0ZSAndmlkZW9zJyxcbiAgICAgICAgICAgIHVybDogJy92aWRlb3MnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aWRlb3MudHBsLmh0bWwnXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnVmlkZW9zQ3RybCdcbiAgICAgICAgLnN0YXRlICd2aWRlbycsXG4gICAgICAgICAgICB1cmw6ICcvdmlkZW8vOmlkJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlkZW8udHBsLmh0bWwnXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnVmlkZW9DdHJsJ1xuIiwiYW5ndWxhci5tb2R1bGUoJ2FuZ3VsYXJ2aWRlbycsIFsndWkucm91dGVyJywgJ25nU2FuaXRpemUnXSkuY29uZmlnKGZ1bmN0aW9uKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcbiAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnL3ZpZGVvcycpO1xuICByZXR1cm4gJHN0YXRlUHJvdmlkZXIuc3RhdGUoJ3ZpZGVvcycsIHtcbiAgICB1cmw6ICcvdmlkZW9zJyxcbiAgICB0ZW1wbGF0ZVVybDogJ3ZpZGVvcy50cGwuaHRtbCcsXG4gICAgY29udHJvbGxlcjogJ1ZpZGVvc0N0cmwnXG4gIH0pLnN0YXRlKCd2aWRlbycsIHtcbiAgICB1cmw6ICcvdmlkZW8vOmlkJyxcbiAgICB0ZW1wbGF0ZVVybDogJ3ZpZGVvLnRwbC5odG1sJyxcbiAgICBjb250cm9sbGVyOiAnVmlkZW9DdHJsJ1xuICB9KTtcbn0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ2FuZ3VsYXJ2aWRlbycpLmNvbnRyb2xsZXIgJ1ZpZGVvQ3RybCcsICgkc2NvcGUsICRzY2UsICRzdGF0ZVBhcmFtcywgVmlkZW9zKS0+XG4gICAgaWRWaWRlbyA9IEpTT04ucGFyc2UoJHN0YXRlUGFyYW1zLmlkKVxuICAgIFZpZGVvcy5nZXRPbmUoaWRWaWRlbykudGhlbiAodmlkZW8pLT5cbiAgICAgICAgIyBjYW5ub3QgYmUgc2V0IHdpdGggJHNjZURlbGVnYXRlUHJvdmlkZXIgc2luY2UgdGhlIHVybCBjb3VsZCBiZSBhbnl0aGluZ1xuICAgICAgICB2aWRlby5zcmMgPSAkc2NlLnRydXN0QXNSZXNvdXJjZVVybCh2aWRlby5zcmMpXG4gICAgICAgICRzY29wZS52aWRlbyA9IHZpZGVvXG4gICAgLCAocmVhc29uKS0+XG4gICAgICAgIGFsZXJ0KHJlYXNvbilcblxuXG5cbiIsImFuZ3VsYXIubW9kdWxlKCdhbmd1bGFydmlkZW8nKS5jb250cm9sbGVyKCdWaWRlb0N0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRzY2UsICRzdGF0ZVBhcmFtcywgVmlkZW9zKSB7XG4gIHZhciBpZFZpZGVvO1xuICBpZFZpZGVvID0gSlNPTi5wYXJzZSgkc3RhdGVQYXJhbXMuaWQpO1xuICByZXR1cm4gVmlkZW9zLmdldE9uZShpZFZpZGVvKS50aGVuKGZ1bmN0aW9uKHZpZGVvKSB7XG4gICAgdmlkZW8uc3JjID0gJHNjZS50cnVzdEFzUmVzb3VyY2VVcmwodmlkZW8uc3JjKTtcbiAgICByZXR1cm4gJHNjb3BlLnZpZGVvID0gdmlkZW87XG4gIH0sIGZ1bmN0aW9uKHJlYXNvbikge1xuICAgIHJldHVybiBhbGVydChyZWFzb24pO1xuICB9KTtcbn0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ2FuZ3VsYXJ2aWRlbycpLmRpcmVjdGl2ZSAnc2Vjb25kc1RvTWludXRlcycsIC0+XG4gICAge1xuICAgICAgICBsaW5rOiAoc2NvcGUsIGVsZW1lbnQsIGF0dHIpLT5cbiAgICAgICAgICAgIHNlY29uZHNUb01pbnV0ZXMgPSAodGltZSktPlxuICAgICAgICAgICAgICAgIG1pbnMgPSB+IH4odGltZSAvIDYwKVxuICAgICAgICAgICAgICAgIHNlY3MgPSB0aW1lICUgNjBcbiAgICAgICAgICAgICAgICBocnMgPSB+IH4odGltZSAvIDM2MDApXG4gICAgICAgICAgICAgICAgbWlucyA9IH4gfih0aW1lICUgMzYwMCAvIDYwKVxuICAgICAgICAgICAgICAgIHNlY3MgPSB0aW1lICUgNjBcbiAgICAgICAgICAgICAgICByZXQgPSAnJ1xuICAgICAgICAgICAgICAgIGlmIG1pbnMgPCAxMCB0aGVuIG1pbnMgPSAnMCcgKyBtaW5zXG4gICAgICAgICAgICAgICAgaWYgaHJzID4gMFxuICAgICAgICAgICAgICAgICAgcmV0ICs9ICcnICsgaHJzICsgJzonICsgKGlmIG1pbnMgPCAxMCB0aGVuICcwJyBlbHNlICcnKVxuICAgICAgICAgICAgICAgIHJldCArPSAnJyArIG1pbnMgKyAnOicgKyAoaWYgc2VjcyA8IDEwIHRoZW4gJzAnIGVsc2UgJycpXG4gICAgICAgICAgICAgICAgcmV0ICs9ICcnICsgc2Vjc1xuICAgICAgICAgICAgICAgIHJldHVybiByZXRcbiAgICAgICAgICAgIGVsZW1lbnQucmVwbGFjZVdpdGgoc2Vjb25kc1RvTWludXRlcyhhdHRyLnNlY29uZHNUb01pbnV0ZXMpKVxuICAgIH1cbiIsImFuZ3VsYXIubW9kdWxlKCdhbmd1bGFydmlkZW8nKS5kaXJlY3RpdmUoJ3NlY29uZHNUb01pbnV0ZXMnLCBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHtcbiAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cikge1xuICAgICAgdmFyIHNlY29uZHNUb01pbnV0ZXM7XG4gICAgICBzZWNvbmRzVG9NaW51dGVzID0gZnVuY3Rpb24odGltZSkge1xuICAgICAgICB2YXIgaHJzLCBtaW5zLCByZXQsIHNlY3M7XG4gICAgICAgIG1pbnMgPSB+fih0aW1lIC8gNjApO1xuICAgICAgICBzZWNzID0gdGltZSAlIDYwO1xuICAgICAgICBocnMgPSB+fih0aW1lIC8gMzYwMCk7XG4gICAgICAgIG1pbnMgPSB+fih0aW1lICUgMzYwMCAvIDYwKTtcbiAgICAgICAgc2VjcyA9IHRpbWUgJSA2MDtcbiAgICAgICAgcmV0ID0gJyc7XG4gICAgICAgIGlmIChtaW5zIDwgMTApIHtcbiAgICAgICAgICBtaW5zID0gJzAnICsgbWlucztcbiAgICAgICAgfVxuICAgICAgICBpZiAoaHJzID4gMCkge1xuICAgICAgICAgIHJldCArPSAnJyArIGhycyArICc6JyArIChtaW5zIDwgMTAgPyAnMCcgOiAnJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0ICs9ICcnICsgbWlucyArICc6JyArIChzZWNzIDwgMTAgPyAnMCcgOiAnJyk7XG4gICAgICAgIHJldCArPSAnJyArIHNlY3M7XG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIGVsZW1lbnQucmVwbGFjZVdpdGgoc2Vjb25kc1RvTWludXRlcyhhdHRyLnNlY29uZHNUb01pbnV0ZXMpKTtcbiAgICB9XG4gIH07XG59KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdhbmd1bGFydmlkZW8nKS5kaXJlY3RpdmUgJ3ZpZGVvSW50ZXJmYWNlJywgLT5cbiAgICB7XG4gICAgICAgIGxpbms6IChzY29wZSwgZWxlbWVudCwgYXR0ciktPlxuICAgICAgICAgICAgdmlkZW9FbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3ZpZGVvJylcbiAgICAgICAgICAgIHZpZGVvU3JjID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc291cmNlJylcbiAgICAgICAgICAgIHZpZGVvRWwuc2V0QXR0cmlidXRlKCdjb250cm9scycsIHRydWUpXG4gICAgICAgICAgICB2aWRlb1NyYy5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAndmlkZW8vbXA0JylcbiAgICAgICAgICAgIHZpZGVvRWwuYXBwZW5kQ2hpbGQodmlkZW9TcmMpXG4gICAgICAgICAgICBlbGVtZW50LnJlcGxhY2VXaXRoIHZpZGVvRWxcbiAgICAgICAgICAgIGxpc3RlbmVyID0gc2NvcGUuJHdhdGNoICd2aWRlbycsICh2aWRlbyktPlxuICAgICAgICAgICAgICAgIGlmIHZpZGVvP1xuICAgICAgICAgICAgICAgICAgICB2aWRlb1NyYy5zZXRBdHRyaWJ1dGUoJ3NyYycsIHZpZGVvLnNyYylcbiAgICAgICAgICAgICAgICAgICAgdmlkZW9FbC5sb2FkKClcbiAgICAgICAgICAgICAgICAgICAgbGlzdGVuZXIoKSAjIGNsZWFyIHRoZSB3YXRjaFxuXG4gICAgICAgICAgICBzY29wZS5zZXRUaW1lID0gKHRpbWUpLT5cbiAgICAgICAgICAgICAgICB2aWRlb0VsLmN1cnJlbnRUaW1lID0gdGltZVxuICAgIH1cbiIsImFuZ3VsYXIubW9kdWxlKCdhbmd1bGFydmlkZW8nKS5kaXJlY3RpdmUoJ3ZpZGVvSW50ZXJmYWNlJywgZnVuY3Rpb24oKSB7XG4gIHJldHVybiB7XG4gICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHIpIHtcbiAgICAgIHZhciBsaXN0ZW5lciwgdmlkZW9FbCwgdmlkZW9TcmM7XG4gICAgICB2aWRlb0VsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndmlkZW8nKTtcbiAgICAgIHZpZGVvU3JjID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc291cmNlJyk7XG4gICAgICB2aWRlb0VsLnNldEF0dHJpYnV0ZSgnY29udHJvbHMnLCB0cnVlKTtcbiAgICAgIHZpZGVvU3JjLnNldEF0dHJpYnV0ZSgndHlwZScsICd2aWRlby9tcDQnKTtcbiAgICAgIHZpZGVvRWwuYXBwZW5kQ2hpbGQodmlkZW9TcmMpO1xuICAgICAgZWxlbWVudC5yZXBsYWNlV2l0aCh2aWRlb0VsKTtcbiAgICAgIGxpc3RlbmVyID0gc2NvcGUuJHdhdGNoKCd2aWRlbycsIGZ1bmN0aW9uKHZpZGVvKSB7XG4gICAgICAgIGlmICh2aWRlbyAhPSBudWxsKSB7XG4gICAgICAgICAgdmlkZW9TcmMuc2V0QXR0cmlidXRlKCdzcmMnLCB2aWRlby5zcmMpO1xuICAgICAgICAgIHZpZGVvRWwubG9hZCgpO1xuICAgICAgICAgIHJldHVybiBsaXN0ZW5lcigpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBzY29wZS5zZXRUaW1lID0gZnVuY3Rpb24odGltZSkge1xuICAgICAgICByZXR1cm4gdmlkZW9FbC5jdXJyZW50VGltZSA9IHRpbWU7XG4gICAgICB9O1xuICAgIH1cbiAgfTtcbn0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ2FuZ3VsYXJ2aWRlbycpLmNvbnRyb2xsZXIgJ1ZpZGVvc0N0cmwnLCAoJHNjb3BlLCBWaWRlb3MpLT5cbiAgICAkc2NvcGUudmlkZW9zID0gW11cbiAgICBWaWRlb3MuZ2V0QWxsKCkudGhlbiAodmlkZW9zKS0+XG4gICAgICAgICRzY29wZS52aWRlb3MgPSB2aWRlb3MuZGF0YVxuICAgICwgKHJlYXNvbiktPlxuICAgICAgICBhbGVydChyZWFzb24pXG5cblxuIiwiYW5ndWxhci5tb2R1bGUoJ2FuZ3VsYXJ2aWRlbycpLmNvbnRyb2xsZXIoJ1ZpZGVvc0N0cmwnLCBmdW5jdGlvbigkc2NvcGUsIFZpZGVvcykge1xuICAkc2NvcGUudmlkZW9zID0gW107XG4gIHJldHVybiBWaWRlb3MuZ2V0QWxsKCkudGhlbihmdW5jdGlvbih2aWRlb3MpIHtcbiAgICByZXR1cm4gJHNjb3BlLnZpZGVvcyA9IHZpZGVvcy5kYXRhO1xuICB9LCBmdW5jdGlvbihyZWFzb24pIHtcbiAgICByZXR1cm4gYWxlcnQocmVhc29uKTtcbiAgfSk7XG59KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdhbmd1bGFydmlkZW8nKS5mYWN0b3J5ICdWaWRlb3MnLCAoJGh0dHAsICRxKS0+XG4gICAge1xuICAgICAgICBnZXRBbGw6IC0+XG4gICAgICAgICAgICBkZWZlcnJlZCA9ICRxLmRlZmVyKClcbiAgICAgICAgICAgICRodHRwLmdldCgnL2FwaS92aWRlb3MnKVxuICAgICAgICAgICAgICAgIC5zdWNjZXNzKChkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZyktPlxuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKVxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAuZXJyb3IoKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKS0+XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZylcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZVxuICAgICAgICBnZXRPbmU6IChpZCktPlxuICAgICAgICAgICAgZGVmZXJyZWQgPSAkcS5kZWZlcigpXG4gICAgICAgICAgICAkaHR0cC5nZXQoXCIvYXBpL3ZpZGVvcy9vbmUvXCIgKyBwYXJzZUludChpZCkpXG4gICAgICAgICAgICAgICAgLnN1Y2Nlc3MoKGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKS0+XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIC5lcnJvcigoZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpLT5cbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKVxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlXG4gICAgfVxuIiwiYW5ndWxhci5tb2R1bGUoJ2FuZ3VsYXJ2aWRlbycpLmZhY3RvcnkoJ1ZpZGVvcycsIGZ1bmN0aW9uKCRodHRwLCAkcSkge1xuICByZXR1cm4ge1xuICAgIGdldEFsbDogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgZGVmZXJyZWQ7XG4gICAgICBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAkaHR0cC5nZXQoJy9hcGkvdmlkZW9zJykuc3VjY2VzcyhmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICByZXR1cm4gZGVmZXJyZWQucmVzb2x2ZShkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZyk7XG4gICAgICB9KS5lcnJvcihmdW5jdGlvbihkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZykge1xuICAgICAgICByZXR1cm4gZGVmZXJyZWQucmVqZWN0KGRhdGEsIHN0YXR1cywgaGVhZGVycywgY29uZmlnKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgfSxcbiAgICBnZXRPbmU6IGZ1bmN0aW9uKGlkKSB7XG4gICAgICB2YXIgZGVmZXJyZWQ7XG4gICAgICBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAkaHR0cC5nZXQoXCIvYXBpL3ZpZGVvcy9vbmUvXCIgKyBwYXJzZUludChpZCkpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgcmV0dXJuIGRlZmVycmVkLnJlc29sdmUoZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpO1xuICAgICAgfSkuZXJyb3IoZnVuY3Rpb24oZGF0YSwgc3RhdHVzLCBoZWFkZXJzLCBjb25maWcpIHtcbiAgICAgICAgcmV0dXJuIGRlZmVycmVkLnJlamVjdChkYXRhLCBzdGF0dXMsIGhlYWRlcnMsIGNvbmZpZyk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgIH1cbiAgfTtcbn0pO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9